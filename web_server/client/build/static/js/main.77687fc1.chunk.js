(this["webpackJsonptap-news"]=this["webpackJsonptap-news"]||[]).push([[0],{30:function(e,t,a){e.exports=a.p+"static/media/newspaper.a05250c8.svg"},31:function(e,t,a){e.exports=a(56)},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(6),r=a(0),s=a.n(r),o=a(28),l=a.n(o),i=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function c(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var m=a(4),u=a(5),d=a(8),p=a(7),h=(a(47),a(48),a(49),function(){function e(){Object(m.a)(this,e)}return Object(u.a)(e,null,[{key:"authenticateUser",value:function(e,t){localStorage.setItem("token",e),localStorage.setItem("email",t)}},{key:"isUserAuthenticated",value:function(){return null!==localStorage.getItem("token")}},{key:"deauthenticateUser",value:function(){localStorage.removeItem("token"),localStorage.removeItem("email")}},{key:"getToken",value:function(){return localStorage.getItem("token")}},{key:"getEmail",value:function(){return localStorage.getItem("email")}}]),e}()),g=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"redirectToUrl",value:function(e,t){t.preventDefault(),this.sendClickLog(),window.open(e,"_blank")}},{key:"sendClickLog",value:function(){var e="http://"+window.location.hostname+":3000/news/userId="+h.getEmail()+"&newsId="+this.props.news.digest,t=new Request(encodeURI(e),{method:"POST",headers:{Authorization:"bearer "+h.getToken()}});fetch(t)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"news-container",onClick:function(t){return e.redirectToUrl(e.props.news.url,t)}},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col s4 fill"},s.a.createElement("img",{src:this.props.news.urlToImage,alt:"news"})),s.a.createElement("div",{className:"col s8"},s.a.createElement("div",{className:"news-intro-col"},s.a.createElement("div",{className:"news-intro-panel"},s.a.createElement("h4",null,this.props.news.title),s.a.createElement("div",{className:"news-description"},s.a.createElement("p",null,this.props.news.description),s.a.createElement("div",null,null!=this.props.news.source&&s.a.createElement("div",{className:"chip light-blue news-chip"},this.props.news.source),null!=this.props.news.reason&&s.a.createElement("div",{className:"chip light-green news-chip"},this.props.news.reason),null!=this.props.news.time&&s.a.createElement("div",{className:"chip amber news-chip"},this.props.news.time))))))))}}]),a}(s.a.Component),w=a(29),v=a.n(w),f=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(m.a)(this,a),(e=t.call(this)).state={news:null,pageNum:1,loadedAll:!1},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.loadMoreNews(),this.loadMoreNews=v.a.debounce(this.loadMoreNews,1e3),window.addEventListener("scroll",(function(){return e.handleScroll()}))}},{key:"handleScroll",value:function(){var e=window.scrollY||window.pageYOffset||document.documentElement.scrollTop;window.innerHeight+e>=document.body.offsetHeight-50&&(console.log("Handle Scoller"),this.loadMoreNews())}},{key:"renderNews",value:function(){var e=this.state.news.map((function(e){return s.a.createElement("a",{className:"list-group-item",key:e.digest,href:"#"},s.a.createElement(g,{news:e}))}));return s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"list-group"},e))}},{key:"loadMoreNews",value:function(){var e=this;if(1!=this.loadedAll){console.log("Load more news!!!");var t="http://"+window.location.hostname+":3000/news/userId="+h.getEmail()+"&pageNum="+this.state.pageNum,a=new Request(encodeURI(t),{method:"GET",headers:{Authorization:"bearer "+h.getToken()}});fetch(a).then((function(e){return e.json()})).then((function(t){t&&0!=t.length||(console.log("====newsPanel.js loadedAll====0000"),e.setState({loadedAll:!0})),console.log("====newsPanel.js print news===="),e.setState({news:e.state.news?e.state.news.concat(t):t,pageNum:e.state.pageNum+1})}))}}},{key:"render",value:function(){return this.state.news?s.a.createElement("div",null,this.renderNews()):s.a.createElement("div",null,"Loading...")}}]),a}(s.a.Component),E=a(30),N=a.n(E),b=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("img",{className:"logo",src:N.a,alt:"logo",width:"140",height:"180"}),s.a.createElement("div",{className:"container"},s.a.createElement(f,null)))}}]),a}(s.a.Component),y=(a(51),a(52),a(53),function(e){var t=e.children;return s.a.createElement("div",null,s.a.createElement("nav",{className:"nav-bar indigo lighten-1"},s.a.createElement("div",{className:"nav-wrapper"},s.a.createElement("a",{href:"/",className:"brand-logo"},"   Tap News"),s.a.createElement("ul",{id:"nav-modbile",className:"right"},h.isUserAuthenticated()?s.a.createElement("div",null,s.a.createElement("li",null,h.getEmail()),s.a.createElement("li",null,s.a.createElement(n.a,{to:"/logout"},"Log out"))):s.a.createElement("div",null,s.a.createElement("li",null,s.a.createElement(n.a,{to:"/login"},"Log in")),s.a.createElement("li",null,s.a.createElement(n.a,{to:"/signup"},"Sign up")))))),s.a.createElement("br",null),t)}),k=(a(54),function(e){var t=e.onSubmit,a=e.onChange,r=e.errors;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"card-panel login-panel"},s.a.createElement("form",{className:"col s12",action:"/",onSubmit:t},s.a.createElement("h4",{className:"center-align"},"Login"),r.summary&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},r.summary)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{className:"validate",id:"email",type:"email",name:"email",onChange:a}),s.a.createElement("label",{htmlFor:"email"},"Email"))),r.email&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},r.email)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{className:"validate",id:"password",type:"password",name:"password",onChange:a}),s.a.createElement("label",{htmlFor:"password"},"Password"))),r.password&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},r.password)),s.a.createElement("div",{className:"row right-align"},s.a.createElement("input",{type:"submit",className:"waves-effect waves-light btn indigo lighten-1",value:"Log in"})),s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"right-align"}," New to Tap News? ",s.a.createElement(n.a,{to:"/signup"},"Sign Up"))))))}),S=a(1),j=a.n(S),O=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e,n){var r;return Object(m.a)(this,a),(r=t.call(this,e,n)).state={errors:{},user:{email:"",password:""}},r}return Object(u.a)(a,[{key:"processForm",value:function(e){var t=this;e.preventDefault();var a=this.state.user.email,n=this.state.user.password;console.log("email:",a),console.log("password",n);var r="http://"+window.location.hostname+":3000/auth/login",s=new Request(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.state.user.email,password:this.state.user.password})});fetch(s).then((function(e){200===e.status?(t.setState({errors:{}}),e.json().then((function(e){console.log(e),console.log("=======token should match with server========="),h.authenticateUser(e.token,a),console.log("=============redireact to root, since client already login, App component will be shown=========.="),t.context.router.replace("/")}))):(console.log("Login failed"),e.json().then((function(e){var a=e.errors?e.errors:{};a.summary=e.message,t.setState({errors:a})})))}))}},{key:"changeUser",value:function(e){var t=e.target.name,a=this.state.user;a[t]=e.target.value,this.setState({user:a})}},{key:"render",value:function(){var e=this;return s.a.createElement(k,{onSubmit:function(t){return e.processForm(t)},onChange:function(t){return e.changeUser(t)},errors:this.state.errors})}}]),a}(s.a.Component);O.contextTypes={router:j.a.object.isRequired};var C=O,U=(a(55),function(e){var t=e.onSubmit,a=e.onChange,r=e.errors;e.user;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"card-panel signup-panel"},s.a.createElement("form",{className:"col s12",action:"/",onSubmit:t},s.a.createElement("h4",{className:"center-align"},"Sign Up"),r.summary&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},r.summary)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{className:"validate",id:"email",type:"email",name:"email",onChange:a}),s.a.createElement("label",{htmlFor:"email"},"Email"))),r.email&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},r.email)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{className:"validate",id:"password",type:"password",name:"password",onChange:a}),s.a.createElement("label",{htmlFor:"password"},"Password"))),r.password&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},r.password)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"confirm_password",type:"password",name:"confirm_password",className:"validate",onChange:a}),s.a.createElement("label",{htmlFor:"confirm_password"},"Confirm Password"))),s.a.createElement("div",{className:"row right-align"},s.a.createElement("input",{type:"submit",className:"waves-effect waves-light btn indigo lighten-1",value:"Sign Up"})),s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"right-align"},"Already have account? ",s.a.createElement(n.a,{to:"/login"},"Login"))))))}),T=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e,n){var r;return Object(m.a)(this,a),(r=t.call(this,e,n)).state={errors:{},user:{email:"",password:"",confirm_password:""}},r}return Object(u.a)(a,[{key:"processForm",value:function(e){var t=this;e.preventDefault();var a=this.state.user.email,n=this.state.user.password,r=this.state.user.confirm_password;console.log("email: ",a),console.log("password: ",n),console.log("confirm_password: ",r);var s="http://"+window.location.hostname+":3000/auth/signup",o=new Request(s,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.state.user.email,password:this.state.user.password})});fetch(o).then((function(e){console.log("====SignUpPage.js fetch(request)======="),200===e.status?(t.setState({errors:{}}),t.context.router.replace("/login")):e.json().then((function(e){console.log(e);var a=e.errors?e.errors:{};a.summary=e.message,console.log(t.state.errors),t.setState({errors:a})}))}))}},{key:"changeUser",value:function(e){var t=e.target.name,a=this.state.user;if(a[t]=e.target.value,this.setState({user:a}),this.state.user.password!==this.state.user.confirm_password){var n=this.state.errors;n.password="Password and Confirm Password don't match.",this.setState({errors:n})}else{var r=this.state.errors;r.password="",this.setState({errors:r})}}},{key:"render",value:function(){var e=this;return s.a.createElement(U,{onSubmit:function(t){return e.processForm(t)},onChange:function(t){return e.changeUser(t)},errors:this.state.errors,user:this.state.user})}}]),a}(s.a.Component);T.contextTypes={router:j.a.object.isRequired};var A={component:y,childRoutes:[{path:"/",getComponent:function(e,t){h.isUserAuthenticated()?t(null,b):t(null,C)}},{path:"/login",component:C},{path:"/signup",component:T},{path:"/logout",onEnter:function(e,t){h.deauthenticateUser(),t("/")}}]};l.a.render(s.a.createElement(n.b,{history:n.c,routes:A}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");i?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):c(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):c(t,e)}))}}()}},[[31,1,2]]]);
//# sourceMappingURL=main.77687fc1.chunk.js.map